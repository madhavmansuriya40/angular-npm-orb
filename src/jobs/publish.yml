description: >
  Publish

parameters:
  path:
    type: string
  access:
    type: string
    default: public
  NPM_USER:
    type: string
  NPM_PASS:
    type: string
  NPM_EMAIL:
    type: string
  NPM_REGISTRY:
    type: string
    default: https://npm.pkg.github.com/

executor:
  name: node

steps:
  - attach_workspace:
      at: .
  - run:
      name: Initializing npm publishing
      command: sudo npm install -g npm-cli-adduser && npm-cli-adduser -u <<parameters.NPM_USER>> -p <<parameters.NPM_PASS>> -e <<parameters.NPM_EMAIL>> -r <<parameters.NPM_REGISTRY>>
  - run:
      name: Publishing npm package
      command: cd <<parameters.path>> && npm publish --access=<<parameters.NPM_ACCESS>>
